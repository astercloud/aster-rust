#!/bin/sh

# Rust ä»£ç æ ¼å¼åŒ–
if git diff --cached --name-only | grep -qE '\.(rs)$'; then
  echo "ğŸ¦€ Running cargo fmt..."
  cargo fmt --check
  if [ $? -ne 0 ]; then
    echo "âŒ Rust ä»£ç æ ¼å¼æ£€æŸ¥å¤±è´¥ï¼Œè¯·è¿è¡Œ 'cargo fmt' ä¿®å¤"
    exit 1
  fi
  echo "âœ… Rust æ ¼å¼æ£€æŸ¥é€šè¿‡"
fi

# TypeScript/Desktop ä»£ç æ ¼å¼åŒ–
if git diff --cached --name-only | grep -q "^ui/desktop/"; then
  if [ -d "ui/desktop" ]; then
    echo "ğŸ“¦ Running lint-staged for desktop..."
    cd ui/desktop && npx lint-staged
  else
    echo "Warning: ui/desktop directory does not exist, skipping lint-staged"
  fi
fi
